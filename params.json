{
  "name": "Bifrozt-ansible",
  "tagline": "Deploy Bifrozt using Ansible",
  "body": "---\r\n\r\nThis document will provide an overview of how the Bifrozt deployment should look like and how it will work once it's complete, define the requirements for this deployment, explain the two different ways to deploy Bifrozt and provide a step by step instruction of the most common method.\r\n\r\n---\r\n\r\n#### Overview.\r\n\r\nGenerally speaking, Bifrozt is a NAT device with a DHCP server that is usually deployed with one NIC (eth0) connected directly to the Internet and one NIC (eth1) connected to the internal network.<br>\r\n\r\n![Example deployment](https://www.honeynet.org/sites/default/files/images/deploy_example.png)\r\n\r\nWhat differentiates Bifrozt from other standard NAT devices is its ability to work as a transparent SSHv2 proxy between an attacker and your honeypot. The software that's being used as a SSHv2 proxy is called [HonSSH](https://github.com/tnich/honssh) and has been developed by Thomas Nicholson.\r\n<br><br>\r\nIf you deployed a SSH server on Bifrozt's internal network it would log all the interaction to a TTY file in plain text that could be viewed later and capture a copy of any files that were downloaded. You do not have to install any additional software, compile any kernel modules or use a specific version or type of operating system on the internal SSH server for this to work\r\n<br><br>\r\nTo prevent the attackers from using the honeypot to attack other systems it will limit outbound traffic to a set number of ports, number of connections and the amount of packets being sent, if the firewall finds that any of these limits are exceeded it will start to drop the connections and/or packets sent.\r\n\r\n---\r\n\r\n#### Requirements.\r\n\r\n##### Hardware.\r\n\r\nMinimum hardware requirements (recommended within parenthesis).\r\n\r\nBifrozt\r\n- 2x network interface cards\r\n- 1 GB RAM (2 GB or more recommended)\r\n- 10 GB Hard drive (20 GB or more recommended)\r\n- 1 CPU (2 or more recommended)\r\n\r\nHoneypot\r\n- The hardware requirements should reflect the type of server thats being offered.\r\n\r\n##### Software\r\n\r\nBifrozt\r\n- Running Ubuntu 14.04 or later (server version recommended but, works with Desktop version as well).\r\n- OpenSSH server (will be added automatically if using local installation method)\r\n\r\nHoneypot\r\n- OpenSSH server\r\n\r\n---\r\n\r\n#### Installation options.\r\n\r\nThere are mainly two ways of installing the components that turns a system into a honeypot router (aka. Bifrozt)\r\n- **Install locally using Ansible.**<br>  If you only plan in using a single instance of Bifrozt (which is the most common way of doing it) you should install it locally.\r\n- **Install from a Ansible control machine.**<br>  If you have a large infrastructure, plan on deploying Bifrozt to multiple nodes or already have a Ansible control machine installed its only natural to deploy Bifrozt from that.\r\n\r\nIf you already are using Ansible and have a control machine I assume that you are able to deploy without any further instructions. \r\n<br>\r\n\r\n##### Install locally using Ansible.\r\n\r\nThis is the most common way of deploying Bifrozt but, can also be a bit tricky if you never used Ansible before, so i've created a bash script that does most of the tasks for you.<br>\r\nEven tho i've created this script i'd like you to be aware of what this script is doing, this will help you troubleshoot any potential issues with it and give a better understanding of the process.\r\n<br><br>\r\nWhen executed it will preform three checks that **must** be passed\r\n- The executing user is *root*.\r\n- The operating system is *Ubuntu*.\r\n- The system has two network interface cards (not counting local interface) and both starts with *eth*.\r\n\r\nTo run the playbook locally on the machine you would like to use as Bifrozt, execute the following commands<br>\r\n`wget https://raw.githubusercontent.com/Bifrozt/bifrozt-ansible/master/bifrozt_setup.sh`<br>\r\n\r\nThis will download the `bifrozt_setup.sh`, to run it you have to find the MAC address of your honeypot. The MAC address must be given as an argument to the script as shown in the example below.\r\n\r\n`sudo bash bifrozt_setup.sh 00:11:22:33:44:55`<br>\r\n<br>\r\n\r\nWhen the script completes you will see a post setup summary, similar to this:<br>\r\n```\r\n=================================================\r\n\r\nPost setup actions:\r\n    1) If the honeypot is running, power it off now.\r\n    2) Reboot this machine.\r\n    3) Reconnect: ssh -l [name of user] 10.109.133.14 -p 59051 \r\n    4) Start the honeypot.\r\n    5) Start HonSSH: sudo honsshctrl start.\r\n\r\n=================================================\r\n```\r\nMake sure to take note of what port number has been chosen for SSH administration,<br>\r\nthis displayed in **3)**. In this case the SSH server has been configured to run on port **59051**.<br>\r\nWhat should be mentioned is that, when starting HonSSH, it will start to tail its application log. This is only for convenience, pressing CTRL + C will stop `honsshctrl` from tailing the log but, it will **not** stop HonSSH.   \r\n\r\n---\r\n\r\nExample of what the `bifrozt_setup.sh` script will look like.<br>\r\n\r\n```\r\n========= bifrozt_setup.sh - 0.0.7 - 2016-02-24 - Are Hansen =========\r\n\r\n\r\n2016-03-18 19:46:37 - [OKAY]: Are we root?...Yes \r\n2016-03-18 19:46:37 - [OKAY]: Are we running Ubuntu?...Yes \r\n2016-03-18 19:46:37 - [OKAY]: Do we have two network interface cards?...Yes \r\n2016-03-18 19:46:37 - [TASK]: Installing all avalible system updates... \r\n2016-03-18 19:49:10 - [OKAY]: All avalible system updates have been installed. \r\n2016-03-18 19:49:11 - [TASK]: Installing base dependencies... \r\n2016-03-18 19:49:11 - [OKAY]: Base dependencies has been installed. \r\n2016-03-18 19:49:11 - [TASK]: Adding Ansible PPA...  \r\n2016-03-18 19:49:12 - [OKAY]: Ansible PPA has been added. \r\n2016-03-18 19:49:12 - [TASK]: Installing Ansible...  \r\n2016-03-18 19:49:30 - [OKAY]: Ansible has been installed. \r\n2016-03-18 19:49:30 - [TASK]: Configuring Ansible... \r\n2016-03-18 19:49:30 - [OKAY]: Ansible has been configured. \r\n2016-03-18 19:49:30 - [TASK]: Cloning master branch of Bifrozt into /tmp/bifrozt-ansible... \r\n2016-03-18 19:49:32 - [OKAY]: The master branch of Bifrozt has been cloned into /tmp/bifrozt-ansible. \r\n2016-03-18 19:49:32 - [TASK]: Setting up Ansible SSH keys... \r\n2016-03-18 19:49:32 - [OKAY]: Generation of Ansible SSH keys completed. \r\n2016-03-18 19:49:32 - [TASK]: Setting up authentication key for root user (will be removed later)... \r\n2016-03-18 19:49:32 - [OKAY]: Authentication key for root has been created. \r\n2016-03-18 19:49:32 - [TASK]: Executing the playbook now... \r\n2016-03-18 19:51:05 - [OKAY]: Playbook exited with: 0 \r\n2016-03-18 19:51:05 - [TASK]: Generating IPv4 address of the honeypot... \r\n2016-03-18 19:51:05 - [OKAY]: IPv4 address for the honeypot has been created. \r\n2016-03-18 19:51:05 - [TASK]: Updating the MAC address of the honeypot... \r\n2016-03-18 19:51:05 - [OKAY]: MAC address of the honeypot has been updated. \r\n2016-03-18 19:51:05 - [TASK]: Generating new DHCP network... \r\n2016-03-18 19:51:05 - [OKAY]: Network for the DHCP server has been created. \r\n2016-03-18 19:51:05 - [INFO]: DHCP will be using this network: 192.168.249.0/24 \r\n2016-03-18 19:51:05 - [INFO]: The honeypot will be assigned this IPv4 address: 192.168.249.243 \r\n2016-03-18 19:51:05 - [TASK]: Updating configuration for interface eth1... \r\n2016-03-18 19:51:05 - [OKAY]: Configuration for eth1 has been updated. \r\n2016-03-18 19:51:05 - [TASK]: Restarting the eth1 interface... \r\n2016-03-18 19:51:05 - [OKAY]: Restart of interface eth1 completed. \r\n2016-03-18 19:51:05 - [TASK]: IPv4 address of eth1: 192.168.249.1 \r\n2016-03-18 19:51:05 - [TASK]: Restarting DHCP server... \r\n2016-03-18 19:51:05 - [OKAY]: DHCP server has been restarted. \r\n2016-03-18 19:51:05 - [TASK]: Updating honssh.cfg.default... \r\n2016-03-18 19:51:05 - [OKAY]: Update of honssh.cfg.default completed. \r\n2016-03-18 19:51:05 - [TASK]: Making active configuration file, honssh.cfg, from honssh.cfg.default... \r\n2016-03-18 19:51:05 - [OKAY]: Creation of active configuration file completed. \r\n2016-03-18 19:51:05 - [TASK]: Selecting a new SSH port for Bifrozt administration... \r\n2016-03-18 19:51:05 - [TASK]: Updating sshd_config... \r\n2016-03-18 19:51:05 - [OKAY]: /etc/ssh/sshd_config has been updated. \r\n2016-03-18 19:51:05 - [TASK]: Updating firewall rules... \r\n2016-03-18 19:51:05 - [OKAY]: Firewall rules has been updated. \r\n2016-03-18 19:51:05 - [TASK]: Restarting SSH server... \r\n2016-03-18 19:51:05 - [OKAY]: SSH server was restarted. \r\n2016-03-18 19:51:05 - [INFO]: The SSH server is now running on TCP port: 59051 \r\n2016-03-18 19:51:05 - [TASK]: Applying new firewall rules... \r\n2016-03-18 19:51:05 - [OKAY]: The new firewall rules was applied. \r\n2016-03-18 19:51:05 - [TASK]: Removing existing \"bifrozt-ansible\" repo. \r\n2016-03-18 19:51:05 - [OKAY]: Existing repo was removed. \r\n2016-03-18 19:51:05 - [TASK]: Removing Ansible SSH keys... \r\n2016-03-18 19:51:05 - [OKAY]: Ansible SSH keys was removed. \r\n2016-03-18 19:51:05 - [TASK]: Removing Ansible from the system... \r\n2016-03-18 19:51:07 - [OKAY]: Ansible was removed from the system. \r\n2016-03-18 19:51:07 - [TASK]: Removing Ansible PPA... \r\n2016-03-18 19:51:08 - [OKAY]: Ansible PPA was removed from the system. \r\n2016-03-18 19:51:08 - [OKAY]: Post-execution clean up completed. \r\n2016-03-18 19:51:08 - [OKAY]: Setup completed. \r\n\r\n\r\n=================================================\r\n\r\nPost setup actions:\r\n    1) If the honeypot is running, power it off now.\r\n    2) Reboot this machine.\r\n    3) Reconnect: ssh -l [name of user] 10.109.133.14 -p 59051 \r\n    4) Start the honeypot.\r\n    5) Start HonSSH: sudo honsshctrl start.\r\n\r\n=================================================\r\n\r\n```\r\n\r\n---",
  "google": "",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}